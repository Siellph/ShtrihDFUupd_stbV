# ShtrihDFUupd_stbV
 Стабильная финальная версия утилиты прошивки ККТ ГК Штрих-М с помощью DFU

1) Подключить кассу к ПК с помощью RNDIS.
2) Скопировать папку shtrih_dfu_update в рабочую директорию. В пути к рабочей
директории не должно быть пробелов и других спецсимволов. Например, можно
положить скрипт в C:\shtrih_dfu_update. Директория должна быть доступна на запись
(будут сохраняться временные файлы).
3) Инсталлировать драйвера DFU (папка dfu_driver) если они не установлены в системе.
4) Рядом с Bat файлом необходимо положить файл прошивки upd_app.bin или
upd_app_for_old_frs.bin (можно положить сразу оба файла. скрипт сам определит какой взять)
5) Если есть необходимость в прошивке функциональной лицензии, то рядом с bat файлом
необходимо положить файл с лицензиями licenses.slf .
6) Запускать cmd нужно под администратором потому что в скрипте автоматически
добавляются правила файрволла (разрешается приём широковещательных сообщений
для обнаружения ФР в сети).
7) После запуска Bat файла необходимо дождаться его завершения. Не выключайте питание
Фр до завершения работы скрипта

Файл который необходимо запускать от имени администратора: "dfu_update_and_write_feature_licenses.bat"

Временные файлы, которые после выполнения скрипта можно удалить:
fr_drv.log - логи выполнения срипта и утилит
tables_backup - бэкап таблиц

Для записи новых параметров в таблицы ККТ:
1. Открыть файл "tbl_consol_orig" с помощью MS Excel или LO Calc (если при открытии попросит выбрать кодировку, то выбрать Юникод utf-8)
2. Оставить необходимые поля для редактирования и заполнить их новыми данными
3. Отредактированный файл сохранить как новый, в этой же папке рядом с "dfu_update_and_write_feature_licenses.bat".
Название нового файла - newparam
4. Открыть "dfu_update_and_write_feature_licenses.bat" с помощью Notepad++
5. Раскомментировать строки #147 и #148 (удалить вначале строк "rem ")
